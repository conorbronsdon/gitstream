# Code generated by gitStream - DO NOT EDIT
gitstream-job:
  stage: gitstream-main
  image: gitstream/rules-engine:latest
  only:
    variables:
      - $GITSTREAM_MAIN_JOB
  except:
    variables:
      - $GITSTREAM_BLOCK_MERGE
  script:
    - apk update && apk add git
    - mkdir /code
    - git clone https://gitlab-ci-token:${CI_JOB_TOKEN}${repoUrl} /code/repo
    - git clone https://gitlab-ci-token:${CI_JOB_TOKEN}${cmUrl} /code/cm
    - cd /code && cd repo && git fetch --all && git checkout $base_ref && git pull && ls && git checkout $head_ref && git pull && ls
    - |
      HEAD_REF=$head_ref BASE_REF=$base_ref CLIENT_PAYLOAD="$client_payload" RULES_RESOLVER_URL=$resolver_url \
      RULES_RESOLVER_TOKEN=$resolver_token  DEBUG_MODE=true npm run start
